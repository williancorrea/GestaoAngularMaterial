<ngx-loading [show]="carregandoDados"></ngx-loading>


<div id="product" class="page-layout carded fullwidth inner-scroll">

    <!-- TOP BACKGROUND -->
    <div class="top-bg accent"></div>
    <!-- / TOP BACKGROUND -->

    <!-- CENTER -->
    <div class="center">

        <!-- HEADER -->
        <div class="header accent" fxLayout="row" fxLayoutAlign="space-between center">

            <!-- APP TITLE -->
            <div fxLayout="row" fxLayoutAlign="start center">

                <!-- BOTAO VOLTAR-->
                <button mat-icon-button class="mr-0 mr-sm-16" [routerLink]="'/apps/fretamento/eventual'">
                    <mat-icon>arrow_back</mat-icon>
                </button>

                <div class="product-image mr-8 mr-sm-16" [@animate]="{value:'*',params:{delay:'50ms',scale:'0.2'}}">
                    <mat-icon style="font-size: 60px">directions_bus</mat-icon>
                </div>

                <div fxLayout="column" fxLayoutAlign="start start" [@animate]="{value:'*',params:{delay:'100ms',x:'-25px'}}">
                    <div class="h2">
                        {{tipoPagina === 'EDICAO' ? 'Edição do Fretamento' : 'Novo Fretamento'}}
                    </div>
                    <div class="subtitle secondary-text">
                        <span>Detalhes do fretamento</span>
                    </div>
                </div>
            </div>
            <!-- / APP TITLE -->

            <!-- BOTAO DE SALVAR -->
            <!--            <button mat-raised-button class="save-product-button" (click)="gravarFretamento()">-->
            <!--                <span>{{tipoPagina === 'NOVO' ? 'SALVAR FRETAMENTO' : 'ATUALIZAR FRETAMENTO'}}</span>-->
            <!--            </button>-->
        </div>
        <!-- / HEADER -->

        <!-- CONTENT CARD -->
        <div class="content-card">

            <!-- CONTENT -->
            <div class="content">
                <mat-tab-group>

                    <mat-tab label="Cadastro">

                        <div class="tab-content p-24" fusePerfectScrollbar>

                            <!-- MENSAGENS DE ERRO-->
                            <app-error-service-message [(erro)]="mensagemErro" [erroTipo]="'error'"></app-error-service-message>

                            <div class="horizontal-stepper-wrapper" [formGroup]="formFretamentoEventual">

                                <!-- HORIZONTAL STEPPER EXAMPLE -->
                                <mat-horizontal-stepper class="mat-elevation-z4" [linear]="true">

                                    <!--   ############################## -->
                                    <!--   #    ORCAMENTO                 -->
                                    <!--   ############################## -->
                                    <mat-step [stepControl]="formFretamentoEventual.get('contato')"
                                              *ngIf="formFretamentoEventual.get('situacao').value == 'ORCAMENTO_CONTATO' || formFretamentoEventual.get('situacao').value == 'NAO_CONTRATADO_CONTATO'">

                                        <form fxLayout="column" [formGroup]="formFretamentoEventual.get('contato')">
                                            <ng-template matStepLabel>Orçamento</ng-template>

                                            <div fxFlex="1 0 auto" fxLayoutAlign="start center">
                                                <div fxFlex="75" fxLayoutAlign="end center" class="pr-4" style="margin-bottom: 22px;">
                                                    <div class="pr-4">
                                                        <button mat-raised-button type="button" color="accent" (click)="btnOrcamento()"
                                                                [disabled]="this.formFretamentoEventual.get('situacao').value == 'CONTRATADO' || this.formFretamentoEventual.get('situacao').value == 'NAO_CONTRATADO_CONTATO' || this.formFretamentoEventual.get('situacao').value == 'NAO_CONTRATADO_CLIENTE'">
                                                            Novo Orçamento
                                                        </button>
                                                    </div>
                                                    <div class="pr-4">
                                                        <button mat-raised-button type="button" color="primary" (click)="btnNovoCliente()"
                                                                [disabled]="this.formFretamentoEventual.get('situacao').value == 'CONTRATADO' || this.formFretamentoEventual.get('situacao').value == 'NAO_CONTRATADO_CONTATO' || this.formFretamentoEventual.get('situacao').value == 'NAO_CONTRATADO_CLIENTE'">
                                                            Novo Cliente
                                                        </button>
                                                    </div>
                                                </div>

                                                <div fxFlex="25" fxLayoutAlign="rigth center">
                                                    <mat-form-field appearance="fill" fxFlex="100" class="pr-4">
                                                        <mat-label>Pesquisar</mat-label>
                                                        <mat-icon matSuffix class="secondary-text">search</mat-icon>
                                                        <input matInput type="text" placeholder="Selecione ..."
                                                               [formControl]="cmbClienteForm" [matAutocomplete]="autoCompleteCliente">
                                                        <mat-autocomplete autoActiveFirstOption #autoCompleteCliente="matAutocomplete"
                                                                          [displayWith]="mostrarNomePessoa" (optionSelected)="selecionandoUmCliente($event)">
                                                            <mat-option *ngIf="cmbCarregando" class="is-loading">
                                                                <mat-progress-bar mode="indeterminate"></mat-progress-bar>
                                                            </mat-option>
                                                            <ng-container *ngIf="!cmbCarregando">
                                                                <mat-option *ngFor="let cliente of cmbClienteLista" [value]="cliente">
                                                                    <div style="display: block;">
                                                                        <img *ngIf="(cliente['imagem'] != null && cliente['imagem'].length > 0)" [src]="cliente['imagem']" style="width: 40px; vertical-align: middle; margin-right: 5px; border-radius: 5px;"/>
                                                                        <img *ngIf="(cliente['imagem'] == null || cliente['imagem'].length == 0)" src="assets/wcorrea/img/usuario01.png" style="width: 40px; vertical-align: middle; opacity: 0.4; margin-right: 5px; border-radius: 5px;"/>
                                                                        <span><b>{{cliente['nome']}}</b></span>
                                                                    </div>
                                                                </mat-option>
                                                            </ng-container>
                                                        </mat-autocomplete>
                                                        <mat-error>
                                                            <app-message [control]="cmbClienteForm"></app-message>
                                                        </mat-error>
                                                    </mat-form-field>
                                                </div>
                                            </div>


                                            <div fxFlex="1 0 auto" fxLayoutAlign="start center">
                                                <mat-form-field appearance="outline" fxFlex="50" class="pr-4">
                                                    <mat-label>Nome</mat-label>
                                                    <input matInput formControlName="nome">
                                                    <mat-icon matSuffix class="secondary-text">account_circle</mat-icon>
                                                    <mat-error>
                                                        <app-message [control]="formFretamentoEventual.get('contato').get('nome')"></app-message>
                                                    </mat-error>
                                                </mat-form-field>

                                                <mat-form-field appearance="outline" fxFlex="25" class="pr-4">
                                                    <mat-label>Telefone 1</mat-label>
                                                    <input matInput formControlName="telefone1"
                                                           [mask]="(formFretamentoEventual.get('contato').get('telefone1').value && formFretamentoEventual.get('contato').get('telefone1').value.toString().length <=10) ? '(00) 0000-00009' : '(00) 00000-0000'"
                                                           [validation]="false">
                                                    <mat-icon matSuffix class="secondary-text">phone</mat-icon>
                                                    <mat-error>
                                                        <app-message [control]="formFretamentoEventual.get('contato').get('telefone1')"></app-message>
                                                    </mat-error>
                                                </mat-form-field>

                                                <mat-form-field appearance="outline" fxFlex="25" class="pr-4">
                                                    <mat-label>Telefone 2</mat-label>
                                                    <input matInput formControlName="telefone2"
                                                           [mask]="(formFretamentoEventual.get('contato').get('telefone2').value && formFretamentoEventual.get('contato').get('telefone2').value.toString().length <=10) ? '(00) 0000-00009' : '(00) 00000-0000'"
                                                           [validation]="false">
                                                    <mat-icon matSuffix class="secondary-text">phone</mat-icon>
                                                    <mat-error>
                                                        <app-message [control]="formFretamentoEventual.get('contato').get('telefone2')"></app-message>
                                                    </mat-error>
                                                </mat-form-field>
                                            </div>

                                            <div fxFlex="1 0 auto" fxLayoutAlign="start center">
                                                <mat-form-field appearance="outline" fxFlex="100">
                                                    <mat-label>Observações do contato</mat-label>
                                                    <textarea #contatoObs matInput rows="3" maxlength="500" formControlName="obs"></textarea>
                                                    <mat-hint align="end">{{contatoObs.value.length}} / 500</mat-hint>
                                                    <mat-error>
                                                        <app-message [control]="formFretamentoEventual.get('contato').get('obs')"></app-message>
                                                    </mat-error>
                                                </mat-form-field>
                                            </div>

                                            <div fxLayout="row" fxLayoutAlign="center center">
                                                <button mat-raised-button matStepperNext type="button" color="accent">
                                                    Próximo
                                                </button>
                                            </div>

                                        </form>
                                    </mat-step>

                                    <!--   ############################## -->
                                    <!--   #    CADASTRO DE CLIENTE       -->
                                    <!--   ############################## -->
                                    <mat-step [stepControl]="formFretamentoEventual.get('cliente')"
                                              *ngIf="formFretamentoEventual.get('situacao').value != 'ORCAMENTO_CONTATO' && formFretamentoEventual.get('situacao').value != 'NAO_CONTRATADO_CONTATO'">

                                        <form fxLayout="column" [formGroup]="formFretamentoEventual.get('cliente')">
                                            <ng-template matStepLabel>Cliente</ng-template>

                                            <div fxFlex="1 0 auto" fxLayoutAlign="start center">

                                                <div fxFlex="50" class="text-right" fxLayoutAlign="center center">
                                                    <mat-radio-group *ngIf="formFretamentoEventual.get('cliente').get('key').value == null ? true : false" formControlName="tipo" class="centralizar-radio-button"
                                                                     style="width: 100%; text-align: center;">
                                                        <mat-radio-button style="margin: 10px" class="radio-button-espacamento" value="FISICA">Pessoa Física</mat-radio-button>
                                                        <mat-radio-button style="margin: 10px" class="radio-button-espacamento" value="JURIDICA">Pessoa Jurídica</mat-radio-button>
                                                    </mat-radio-group>
                                                </div>

                                                <div fxFlex="25" fxLayoutAlign="end center" class="pr-4" style="margin-bottom: 22px;">
                                                    <div class="pr-4">
                                                        <button mat-raised-button type="button" color="accent" (click)="btnOrcamento()"
                                                                [disabled]="this.formFretamentoEventual.get('situacao').value == 'CONTRATADO' || this.formFretamentoEventual.get('situacao').value == 'NAO_CONTRATADO_CONTATO' || this.formFretamentoEventual.get('situacao').value == 'NAO_CONTRATADO_CLIENTE'">
                                                            Novo Orçamento
                                                        </button>
                                                    </div>
                                                    <div class="pr-4">
                                                        <button mat-raised-button type="button" color="primary" (click)="btnNovoCliente()"
                                                                [disabled]="this.formFretamentoEventual.get('situacao').value == 'CONTRATADO' || this.formFretamentoEventual.get('situacao').value == 'NAO_CONTRATADO_CONTATO' || this.formFretamentoEventual.get('situacao').value == 'NAO_CONTRATADO_CLIENTE'">
                                                            Novo Cliente
                                                        </button>
                                                    </div>
                                                </div>
                                                <div fxFlex="25" fxLayoutAlign="rigth center">
                                                    <mat-form-field appearance="fill" fxFlex="100" class="pr-4">
                                                        <mat-label>Pesquisar</mat-label>
                                                        <mat-icon matSuffix class="secondary-text">search</mat-icon>
                                                        <input matInput type="text" placeholder="Selecione ..."
                                                               [formControl]="cmbClienteForm" [matAutocomplete]="autoCompleteCliente">
                                                        <mat-autocomplete autoActiveFirstOption #autoCompleteCliente="matAutocomplete"
                                                                          [displayWith]="mostrarNomePessoa"
                                                                          (optionSelected)="selecionandoUmCliente($event)">
                                                            <mat-option *ngIf="cmbCarregando" class="is-loading">
                                                                <mat-progress-bar mode="indeterminate"></mat-progress-bar>
                                                            </mat-option>
                                                            <ng-container *ngIf="!cmbCarregando">
                                                                <mat-option *ngFor="let cliente of cmbClienteLista" [value]="cliente">
                                                                    <div style="display: block;">
                                                                        <img *ngIf="(cliente['imagem'] != null && cliente['imagem'].length > 0)" [src]="cliente['imagem']" style="width: 40px; vertical-align: middle; margin-right: 5px; border-radius: 5px;"/>
                                                                        <img *ngIf="(cliente['imagem'] == null || cliente['imagem'].length == 0)" src="assets/wcorrea/img/usuario01.png" style="width: 40px; vertical-align: middle; opacity: 0.4; margin-right: 5px; border-radius: 5px;"/>
                                                                        <span><b>{{cliente['nome']}}</b></span>
                                                                    </div>
                                                                </mat-option>
                                                            </ng-container>
                                                        </mat-autocomplete>
                                                        <mat-error>
                                                            <app-message [control]="cmbClienteForm"></app-message>
                                                        </mat-error>
                                                    </mat-form-field>
                                                </div>
                                            </div>

                                            <mat-divider style="margin: 10px; border: 0.5px solid grey;"></mat-divider>

                                            <mat-grid-list cols="5" rowHeight="87px">
                                                <mat-grid-tile colspan="1" rowspan="2">

                                                    <!--                                                    <div *ngIf="!formFretamentoEventual.get('cliente').get('imagem').value"-->
                                                    <!--                                                         style="top: -10px; position: relative;    border-radius: 10px;    border: 1px solid #ccc; width: 140px;    height: 140px;">-->
                                                    <!--                                                    </div>-->
                                                    <!--                                                    <img *ngIf="formFretamentoEventual.get('cliente').get('imagem').value"-->
                                                    <!--                                                         [src]="formFretamentoEventual.get('cliente').get('imagem').value"-->
                                                    <!--                                                         style="top: -10px; position: relative; border-radius: 10px; border: 1px solid #ccc; width: 140px; height: 140px;"/>-->

                                                    <app-imagem-base64 class="pr-4" [disabled]="(this.formFretamentoEventual.get('situacao').value === 'CONTRATADO'
                                                                                || this.formFretamentoEventual.get('situacao').value === 'NAO_CONTRATADO_CONTATO'
                                                                                || this.formFretamentoEventual.get('situacao').value === 'NAO_CONTRATADO_CLIENTE')"
                                                                       [(imagemBase64)]="imagemCliente" style="top: -10px; position: relative;  width: 140px; height: 140px;"></app-imagem-base64>

                                                </mat-grid-tile>
                                                <mat-grid-tile colspan="4" rowspan="1">
                                                    <div fxFlex="100" fxLayout="row wrap" fxLayoutAlign="start center">
                                                        <mat-form-field appearance="outline" fxFlex="25" class="pr-4"
                                                                        [formGroup]="formFretamentoEventual.get('cliente').get('pessoaFisica')"
                                                                        *ngIf="formFretamentoEventual.get('cliente').get('tipo').value === 'FISICA' ? true : false">
                                                            <mat-label>CPF</mat-label>
                                                            <input matInput formControlName="cpf"
                                                                   [dropSpecialCharacters]="false"
                                                                   mask="000.000.000-00" (ngModelChange)="buscarCpfDigitado()">
                                                            <mat-icon matSuffix class="secondary-text">contact_mail</mat-icon>
                                                            <mat-error>
                                                                <app-message [control]="formFretamentoEventual.get('cliente').get('pessoaFisica').get('cpf')"></app-message>
                                                            </mat-error>
                                                        </mat-form-field>

                                                        <mat-form-field appearance="outline" fxFlex="25" class="pr-4"
                                                                        [formGroup]="formFretamentoEventual.get('cliente').get('pessoaJuridica')"
                                                                        *ngIf="formFretamentoEventual.get('cliente').get('tipo').value === 'FISICA' ? false : true">
                                                            <mat-label>CNPJ</mat-label>
                                                            <input matInput formControlName="cnpj"
                                                                   [dropSpecialCharacters]="false"
                                                                   mask="00.000.000/0000-00" (ngModelChange)="buscarCnpjDigitado()">
                                                            <mat-icon matSuffix class="secondary-text">business</mat-icon>
                                                            <mat-error>
                                                                <app-message [control]="formFretamentoEventual.get('cliente').get('pessoaJuridica').get('cnpj')"></app-message>
                                                            </mat-error>
                                                        </mat-form-field>

                                                        <mat-form-field appearance="outline" fxFlex="50" class="pr-4">
                                                            <mat-label>{{formFretamentoEventual.get('cliente').get('tipo').value === 'FISICA' ? 'Nome' : 'Razão Social' }}</mat-label>
                                                            <input matInput formControlName="nome">
                                                            <mat-error>
                                                                <app-message [control]="formFretamentoEventual.get('cliente').get('nome')"></app-message>
                                                            </mat-error>
                                                        </mat-form-field>

                                                        <mat-form-field appearance="outline" fxFlex="25" class="pr-4">
                                                            <mat-label>{{formFretamentoEventual.get('cliente').get('tipo').value === 'FISICA' ? 'Apelido' : 'Nome Fantasia' }}</mat-label>
                                                            <input matInput formControlName="fantasia">
                                                            <mat-icon matSuffix class="secondary-text">gesture</mat-icon>
                                                            <mat-error>
                                                                <app-message [control]="formFretamentoEventual.get('cliente').get('fantasia')"></app-message>
                                                            </mat-error>
                                                        </mat-form-field>

                                                    </div>
                                                </mat-grid-tile>
                                                <mat-grid-tile colspan="4" rowspan="1">
                                                    <div fxFlex="100" fxLayout="row wrap" fxLayoutAlign="start center">
                                                        <mat-form-field appearance="outline" fxFlex="25" class="pr-4"
                                                                        [formGroup]="formFretamentoEventual.get('cliente').get('pessoaFisica')"
                                                                        *ngIf="formFretamentoEventual.get('cliente').get('tipo').value === 'FISICA' ? true : false">
                                                            <mat-label>RG</mat-label>
                                                            <input matInput formControlName="rg">
                                                            <mat-icon matSuffix class="secondary-text">contact_mail</mat-icon>
                                                            <mat-error>
                                                                <app-message [control]="formFretamentoEventual.get('cliente').get('pessoaFisica').get('rg')"></app-message>
                                                            </mat-error>
                                                        </mat-form-field>

                                                        <mat-form-field appearance="outline" fxFlex="25" class="pr-4"
                                                                        [formGroup]="formFretamentoEventual.get('cliente').get('pessoaJuridica')"
                                                                        *ngIf="formFretamentoEventual.get('cliente').get('tipo').value === 'FISICA' ? false : true">
                                                            <mat-label>Inscrição Estadual</mat-label>
                                                            <input matInput formControlName="inscricaoEstadual" maxlength="15">
                                                            <mat-icon matSuffix class="secondary-text">business</mat-icon>
                                                            <mat-error>
                                                                <app-message [control]="formFretamentoEventual.get('cliente').get('pessoaJuridica').get('inscricaoEstadual')"></app-message>
                                                            </mat-error>
                                                        </mat-form-field>

                                                        <mat-form-field appearance="outline" fxFlex="75" class="pr-4">
                                                            <mat-label>E-mail</mat-label>
                                                            <input matInput formControlName="email">
                                                            <mat-icon matSuffix class="secondary-text">alternate_email</mat-icon>
                                                            <mat-error>
                                                                <app-message [control]="formFretamentoEventual.get('cliente').get('email')"></app-message>
                                                            </mat-error>
                                                        </mat-form-field>
                                                    </div>
                                                </mat-grid-tile>
                                            </mat-grid-list>

                                            <div fxFlex="1 0 auto" fxLayoutAlign="start center">
                                                <mat-form-field appearance="outline" fxFlex="25" class="pr-4">
                                                    <mat-label>Telefone 1</mat-label>
                                                    <input matInput formControlName="telefone1"
                                                           [mask]="(formFretamentoEventual.get('cliente').get('telefone1').value && formFretamentoEventual.get('cliente').get('telefone1').value.toString().length <=10) ? '(00) 0000-00009' : '(00) 00000-0000'"
                                                           [validation]="false">
                                                    <mat-icon matSuffix class="secondary-text">phone</mat-icon>
                                                    <mat-error>
                                                        <app-message [control]="formFretamentoEventual.get('cliente').get('telefone1')"></app-message>
                                                    </mat-error>
                                                </mat-form-field>

                                                <mat-form-field appearance="outline" fxFlex="25" class="pr-4">
                                                    <mat-label>Contato 1</mat-label>
                                                    <input matInput formControlName="telefone1Obs">
                                                    <mat-error>
                                                        <app-message [control]="formFretamentoEventual.get('cliente').get('telefone1Obs')"></app-message>
                                                    </mat-error>
                                                </mat-form-field>

                                                <mat-form-field appearance="outline" fxFlex="25" class="pr-4">
                                                    <mat-label>Telefone 2</mat-label>
                                                    <input matInput formControlName="telefone2"
                                                           [mask]="(formFretamentoEventual.get('cliente').get('telefone2').value && formFretamentoEventual.get('cliente').get('telefone2').value.toString().length <=10) ? '(00) 0000-00009' : '(00) 00000-0000'"
                                                           [validation]="false">
                                                    <mat-icon matSuffix class="secondary-text">phone</mat-icon>
                                                    <mat-error>
                                                        <app-message [control]="formFretamentoEventual.get('cliente').get('telefone2')"></app-message>
                                                    </mat-error>
                                                </mat-form-field>

                                                <mat-form-field appearance="outline" fxFlex="25" class="pr-4">
                                                    <mat-label>Contato 2</mat-label>
                                                    <input matInput formControlName="telefone2Obs">
                                                    <mat-error>
                                                        <app-message [control]="formFretamentoEventual.get('cliente').get('telefone2Obs')"></app-message>
                                                    </mat-error>
                                                </mat-form-field>

                                            </div>

                                            <div fxFlex="1 0 auto" fxLayoutAlign="start center">
                                                <mat-form-field appearance="outline" fxFlex="50" class="pr-4">
                                                    <mat-label>Cidade</mat-label>
                                                    <mat-icon matSuffix class="secondary-text">search</mat-icon>
                                                    <input matInput type="text" placeholder="Pesquisar cidade ..."
                                                           formControlName="cidade" [matAutocomplete]="autoCompleteClienteCidade">
                                                    <mat-autocomplete autoActiveFirstOption #autoCompleteClienteCidade="matAutocomplete"
                                                                      [displayWith]="mostrarNomeCidade">
                                                        <mat-option *ngIf="cmbCarregando" class="is-loading">
                                                            <mat-progress-bar mode="indeterminate"></mat-progress-bar>
                                                        </mat-option>
                                                        <ng-container *ngIf="!cmbCarregando">
                                                            <mat-option *ngFor="let cidade of cmbCidadeLista" [value]="cidade">
                                                                <span><b>{{cidade['nome']}} / {{ cidade['estado']['nome']}}</b></span>
                                                            </mat-option>
                                                        </ng-container>
                                                    </mat-autocomplete>
                                                    <mat-error>
                                                        <app-message [control]="formFretamentoEventual.get('cliente').get('cidade')"></app-message>
                                                    </mat-error>
                                                </mat-form-field>

                                                <mat-form-field appearance="outline" fxFlex="30" class="pr-4">
                                                    <mat-label>Bairro</mat-label>
                                                    <input matInput formControlName="bairro">
                                                    <mat-error>
                                                        <app-message [control]="formFretamentoEventual.get('cliente').get('bairro')"></app-message>
                                                    </mat-error>
                                                </mat-form-field>

                                                <mat-form-field appearance="outline" fxFlex="20" class="pr-4">
                                                    <mat-label>CEP</mat-label>
                                                    <input matInput formControlName="cep" [dropSpecialCharacters]="false" mask="00000-000">
                                                    <mat-icon matSuffix class="secondary-text">location_city</mat-icon>
                                                    <mat-error>
                                                        <app-message [control]="formFretamentoEventual.get('cliente').get('cep')"></app-message>
                                                    </mat-error>
                                                </mat-form-field>

                                            </div>

                                            <div fxFlex="1 0 auto" fxLayoutAlign="start center">
                                                <mat-form-field appearance="outline" fxFlex="100" class="pr-4">
                                                    <mat-label>Endereço</mat-label>
                                                    <input matInput formControlName="endereco">
                                                    <mat-error>
                                                        <app-message [control]="formFretamentoEventual.get('cliente').get('endereco')"></app-message>
                                                    </mat-error>
                                                </mat-form-field>
                                            </div>

                                            <div fxFlex="1 0 auto" fxLayoutAlign="start center">
                                                <mat-form-field appearance="outline" fxFlex="100">
                                                    <mat-label>Observações do cliente</mat-label>
                                                    <textarea #clienteObs matInput formControlName="obs" rows="3" maxlength="500"></textarea>
                                                    <mat-hint align="end">{{clienteObs.value.length}} / 500</mat-hint>
                                                    <mat-error>
                                                        <app-message [control]="formFretamentoEventual.get('cliente').get('obs')"></app-message>
                                                    </mat-error>
                                                </mat-form-field>
                                            </div>

                                            <div fxLayout="row" fxLayoutAlign="center center">
                                                <button mat-raised-button matStepperNext type="button" color="accent">
                                                    Próximo
                                                </button>
                                            </div>

                                        </form>

                                    </mat-step>

                                    <!--   ############################## -->
                                    <!--   #    ITINERARIO                -->
                                    <!--   ############################## -->
                                    <mat-step [stepControl]="formFretamentoEventual.get('itinerario')">
                                        <form fxLayout="column" [formGroup]="formFretamentoEventual.get('itinerario')">

                                            <ng-template matStepLabel>Itinerário</ng-template>

                                            <div fxFlex="1 0 auto" fxLayoutAlign="row">
                                                <mat-form-field appearance="outline" fxFlex="46" class="pr-4">
                                                    <mat-label>Cidade de partida</mat-label>
                                                    <mat-icon matSuffix class="secondary-text">search</mat-icon>
                                                    <input matInput type="text" placeholder="Pesquisar cidade ..."
                                                           formControlName="partidaCidade" [matAutocomplete]="autoCompleteClienteCidadePartida">
                                                    <mat-autocomplete autoActiveFirstOption #autoCompleteClienteCidadePartida="matAutocomplete" [displayWith]="mostrarNomeCidade">
                                                        <mat-option *ngIf="cmbCarregando" class="is-loading">
                                                            <mat-progress-bar mode="indeterminate"></mat-progress-bar>
                                                        </mat-option>
                                                        <ng-container *ngIf="!cmbCarregando">
                                                            <mat-option *ngFor="let cidade of cmbCidadeLista" [value]="cidade">
                                                                <span><b>{{cidade['nome']}} / {{ cidade['estado']['nome']}}</b></span>
                                                            </mat-option>
                                                        </ng-container>
                                                    </mat-autocomplete>
                                                    <mat-error>
                                                        <app-message [control]="formFretamentoEventual.get('itinerario').get('partidaCidade')"></app-message>
                                                    </mat-error>
                                                </mat-form-field>

                                                <mat-form-field appearance="outline" fxFlex="16" class="pr-4">
                                                    <mat-label>Data de Partida</mat-label>
                                                    <input matInput formControlName="partidaData" [matDatepicker]="dpPartidaData" (ngModelChange)="calcularPrevisaoChegada()">
                                                    <mat-datepicker-toggle matSuffix [for]="dpPartidaData"></mat-datepicker-toggle>
                                                    <mat-datepicker #dpPartidaData></mat-datepicker>
                                                    <mat-error>
                                                        <app-message [control]="formFretamentoEventual.get('itinerario').get('partidaData')"></app-message>
                                                    </mat-error>
                                                </mat-form-field>

                                                <mat-form-field appearance="outline" fxFlex="16" class="pr-4">
                                                    <mat-label>Hora de Partida</mat-label>
                                                    <input matInput formControlName="partidaHora" mask="00:00" [dropSpecialCharacters]="false" (ngModelChange)="calcularPrevisaoChegada()">
                                                    <mat-icon matSuffix class="secondary-text">access_time</mat-icon>
                                                    <mat-error>
                                                        <app-message [control]="formFretamentoEventual.get('itinerario').get('partidaHora')"></app-message>
                                                    </mat-error>
                                                </mat-form-field>

                                                <mat-form-field appearance="outline" fxFlex="21" class="pr-4 wcorrea-input-readyonly">
                                                    <mat-label>Previsão de Chegada</mat-label>
                                                    <input matInput formControlName="previsaoChegadaPartida" readonly style="color: blue">
                                                    <mat-icon matSuffix class="secondary-text">timer</mat-icon>
                                                </mat-form-field>
                                            </div>

                                            <div fxFlex="1 0 auto" fxLayoutAlign="start center">
                                                <mat-form-field appearance="outline" fxFlex="100" class="pr-4">
                                                    <mat-label>Local de Saída</mat-label>
                                                    <input matInput formControlName="localSaida" maxlength="250">
                                                    <mat-error>
                                                        <app-message [control]="formFretamentoEventual.get('itinerario').get('localSaida')"></app-message>
                                                    </mat-error>
                                                </mat-form-field>
                                            </div>

                                            <div fxFlex="1 0 auto" fxLayoutAlign="row">
                                                <mat-form-field appearance="outline" fxFlex="46" class="pr-4">
                                                    <mat-label>Cidade de destino</mat-label>
                                                    <mat-icon matSuffix class="secondary-text">search</mat-icon>
                                                    <input matInput type="text" placeholder="Pesquisar cidade ..."
                                                           formControlName="retornoCidade" [matAutocomplete]="autoCompleteClienteCidadeRetorno">
                                                    <mat-autocomplete autoActiveFirstOption #autoCompleteClienteCidadeRetorno="matAutocomplete" [displayWith]="mostrarNomeCidade">
                                                        <mat-option *ngIf="cmbCarregando" class="is-loading">
                                                            <mat-progress-bar mode="indeterminate"></mat-progress-bar>
                                                        </mat-option>
                                                        <ng-container *ngIf="!cmbCarregando">
                                                            <mat-option *ngFor="let cidade of cmbCidadeLista" [value]="cidade">
                                                                <span><b>{{cidade['nome']}} / {{ cidade['estado']['nome']}}</b></span>
                                                            </mat-option>
                                                        </ng-container>
                                                    </mat-autocomplete>
                                                    <mat-error>
                                                        <app-message [control]="formFretamentoEventual.get('itinerario').get('retornoCidade')"></app-message>
                                                    </mat-error>
                                                </mat-form-field>

                                                <mat-form-field appearance="outline" fxFlex="16" class="pr-4">
                                                    <mat-label>Data de retorno</mat-label>
                                                    <input matInput formControlName="retornoData" [matDatepicker]="dpRetornoData" (ngModelChange)="calcularPrevisaoChegada()">
                                                    <mat-datepicker-toggle matSuffix [for]="dpRetornoData"></mat-datepicker-toggle>
                                                    <mat-datepicker #dpRetornoData></mat-datepicker>
                                                    <mat-error>
                                                        <app-message [control]="formFretamentoEventual.get('itinerario').get('retornoData')"></app-message>
                                                    </mat-error>
                                                </mat-form-field>

                                                <mat-form-field appearance="outline" fxFlex="16" class="pr-4">
                                                    <mat-label>Hora de retorno</mat-label>
                                                    <input matInput formControlName="retornoHora" mask="00:00" [dropSpecialCharacters]="false" (ngModelChange)="calcularPrevisaoChegada()">
                                                    <mat-icon matSuffix class="secondary-text">access_time</mat-icon>
                                                    <mat-error>
                                                        <app-message [control]="formFretamentoEventual.get('itinerario').get('retornoHora')"></app-message>
                                                    </mat-error>
                                                </mat-form-field>

                                                <mat-form-field appearance="outline" fxFlex="21" class="pr-4 wcorrea-input-readyonly">
                                                    <mat-label>Previsão de Chegada</mat-label>
                                                    <input matInput formControlName="previsaoChegadaRetorno" readonly style="color: blue">
                                                    <mat-icon matSuffix class="secondary-text">timer</mat-icon>
                                                </mat-form-field>
                                            </div>

                                            <div fxFlex="1 0 auto" fxLayoutAlign="start center">
                                                <mat-form-field appearance="outline" fxFlex="100" class="pr-4">
                                                    <mat-label>Local de Retorno</mat-label>
                                                    <input matInput formControlName="localRetorno" maxlength="250">
                                                    <mat-error>
                                                        <app-message [control]="formFretamentoEventual.get('itinerario').get('localRetorno')"></app-message>
                                                    </mat-error>
                                                </mat-form-field>
                                            </div>

                                            <div fxFlex="1 0 auto" fxLayout="row wrap">
                                                <mat-form-field appearance="outline" fxFlex="28" class="pr-4">
                                                    <mat-label>Veículo</mat-label>
                                                    <mat-icon matSuffix class="secondary-text">search</mat-icon>
                                                    <input matInput type="text" placeholder="Pesquisar veículo ..."
                                                           formControlName="veiculo" [matAutocomplete]="autoCompleteVeiculo">
                                                    <mat-autocomplete autoActiveFirstOption #autoCompleteVeiculo="matAutocomplete" [displayWith]="mostrarNomeVeiculo" (optionSelected)="calcularPrevisaoChegada()">
                                                        <mat-option *ngIf="cmbCarregando" class="is-loading">
                                                            <mat-progress-bar mode="indeterminate"></mat-progress-bar>
                                                        </mat-option>
                                                        <ng-container *ngIf="!cmbCarregando">
                                                            <mat-option *ngFor="let veiculo of cmbVeiculoLista" [value]="veiculo">
                                                                <span><b>{{veiculo['frota'] | uppercase}} - {{veiculo['placa'] | uppercase}}</b></span>
                                                            </mat-option>
                                                        </ng-container>
                                                    </mat-autocomplete>
                                                    <mat-error>
                                                        <app-message [control]="formFretamentoEventual.get('itinerario').get('veiculo')"></app-message>
                                                    </mat-error>
                                                </mat-form-field>

                                                <mat-form-field appearance="outline" fxFlex="18" class="pr-4">
                                                    <mat-label>Km TOTAL percorrido</mat-label>
                                                    <span matSuffix class="secondary-text">Km</span>
                                                    <input matInput type="number" style="text-align: right" formControlName="kmPercorridoQuantidade" (ngModelChange)="calcularPrevisaoChegada(); calcularDespesas();">
                                                    <mat-error>
                                                        <app-message [control]="formFretamentoEventual.get('itinerario').get('kmPercorridoQuantidade')"></app-message>
                                                    </mat-error>
                                                </mat-form-field>
                                            </div>

                                            <div fxFlex="1 0 auto" fxLayoutAlign="start center">
                                                <mat-form-field appearance="outline" fxFlex="100">
                                                    <mat-label>Observações do itinerário</mat-label>
                                                    <textarea #itinerarioObs matInput formControlName="obsItineratio" rows="3" maxlength="500"></textarea>
                                                    <mat-hint align="end">{{itinerarioObs.value.length}} / 500</mat-hint>
                                                    <mat-error>
                                                        <app-message [control]="formFretamentoEventual.get('itinerario').get('obsItineratio')"></app-message>
                                                    </mat-error>
                                                </mat-form-field>
                                            </div>


                                            <div fxLayout="row" fxLayoutAlign="center center">
                                                <button class="mr-8" mat-raised-button matStepperPrevious type="button" color="accent">
                                                    Voltar
                                                </button>
                                                <button mat-raised-button matStepperNext type="button" color="accent">
                                                    Próximo
                                                </button>
                                            </div>

                                        </form>
                                    </mat-step>

                                    <!--   ############################## -->
                                    <!--   #    CUSTO                     -->
                                    <!--   ############################## -->
                                    <mat-step [stepControl]="formFretamentoEventual.get('custo')">
                                        <form fxLayout="column" [formGroup]="formFretamentoEventual.get('custo')">

                                            <ng-template matStepLabel>Custos</ng-template>

                                            <div fxFlex="1 0 auto" fxLayoutAlign="row">
                                                <mat-form-field appearance="outline" fxFlex="35" class="pr-4">
                                                    <mat-label>Nota Fiscal</mat-label>
                                                    <mat-select formControlName="notaFiscalTipo" (selectionChange)="calcularDespesas()">
                                                        <mat-option value="SEM_NOTA">Sem Nota</mat-option>
                                                        <mat-option value="NOTA_SERVICO">NFe - Nota Fiscal eletrônica</mat-option>
                                                        <mat-option value="CTE_OS">CTeOS - Conhecimento de Transporte Eletrônico</mat-option>
                                                    </mat-select>
                                                    <mat-error>
                                                        <app-message [control]="formFretamentoEventual.get('custo').get('notaFiscalTipo')"></app-message>
                                                    </mat-error>
                                                </mat-form-field>

                                                <div fxFlex="1 0 auto" fxLayoutAlign="end center" fxFlex="97">
                                                    <button mat-fab type="button" color="{{formacaoPreco ? 'warn' : 'accent'}}" aria-label="Mostrar/Ocultar Formação de preço" (click)="mostrarFormacaoPreco()">
                                                        <mat-icon>remove_red_eye</mat-icon>
                                                    </button>
                                                </div>
                                            </div>

                                            <div fxFlex="1 0 auto" fxLayoutAlign="row">
                                                <mat-form-field appearance="outline" fxFlex="35" class="pr-4">
                                                    <mat-label>Motorista 1</mat-label>
                                                    <mat-icon matSuffix class="secondary-text">search</mat-icon>
                                                    <input matInput type="text" placeholder="Pesquisar motorista ..."
                                                           formControlName="motorista1" [matAutocomplete]="autoCompleteMotorista1">
                                                    <mat-autocomplete autoActiveFirstOption #autoCompleteMotorista1="matAutocomplete" [displayWith]="mostrarNomePessoa">
                                                        <mat-option *ngIf="cmbCarregando" class="is-loading">
                                                            <mat-progress-bar mode="indeterminate"></mat-progress-bar>
                                                        </mat-option>
                                                        <ng-container *ngIf="!cmbCarregando">
                                                            <mat-option *ngFor="let motorista of cmbMotoristaLista" [value]="motorista">
                                                                <div style="display: block;">
                                                                    <img *ngIf="(motorista['imagem'] != null && motorista['imagem'].length > 0)" [src]="motorista['imagem']" style="width: 40px; vertical-align: middle; margin-right: 5px; border-radius: 5px;"/>
                                                                    <img *ngIf="(motorista['imagem'] == null || motorista['imagem'].length == 0)" src="assets/wcorrea/img/usuario01.png" style="width: 40px; vertical-align: middle; opacity: 0.4; margin-right: 5px; border-radius: 5px;"/>
                                                                    <span><b>{{motorista['nome']}}</b></span>
                                                                </div>
                                                            </mat-option>
                                                        </ng-container>
                                                    </mat-autocomplete>
                                                    <mat-error>
                                                        <app-message [control]="formFretamentoEventual.get('custo').get('motorista1')"></app-message>
                                                    </mat-error>
                                                </mat-form-field>

                                                <mat-form-field appearance="outline" fxFlex="15" class="pr-4">
                                                    <!--                                                    <mat-icon matPrefix class="secondary-text">monetization_on</mat-icon>-->
                                                    <mat-label>Total das diária</mat-label>
                                                    <input currencyMask matInput formControlName="valorMotorista1Diaria" (ngModelChange)="calcularDespesas()">
                                                    <mat-error>
                                                        <app-message [control]="formFretamentoEventual.get('custo').get('valorMotorista1Diaria')"></app-message>
                                                    </mat-error>
                                                </mat-form-field>

                                                <mat-form-field appearance="outline" fxFlex="35" class="pr-4">
                                                    <mat-label>Motorista 2</mat-label>
                                                    <mat-icon matSuffix class="secondary-text">search</mat-icon>
                                                    <input matInput type="text" placeholder="Pesquisar motorista ..."
                                                           formControlName="motorista2" [matAutocomplete]="autoCompleteMotorista2">
                                                    <mat-autocomplete autoActiveFirstOption #autoCompleteMotorista2="matAutocomplete" [displayWith]="mostrarNomePessoa">
                                                        <mat-option *ngIf="cmbCarregando" class="is-loading">
                                                            <mat-progress-bar mode="indeterminate"></mat-progress-bar>
                                                        </mat-option>
                                                        <ng-container *ngIf="!cmbCarregando">
                                                            <mat-option *ngFor="let motorista of cmbMotoristaLista" [value]="motorista">
                                                                <div style="display: block;">
                                                                    <img *ngIf="(motorista['imagem'] != null && motorista['imagem'].length > 0)" [src]="motorista['imagem']" style="width: 40px; vertical-align: middle; margin-right: 5px; border-radius: 5px;"/>
                                                                    <img *ngIf="(motorista['imagem'] == null || motorista['imagem'].length == 0)" src="assets/wcorrea/img/usuario01.png" style="width: 40px; vertical-align: middle; opacity: 0.4; margin-right: 5px; border-radius: 5px;"/>
                                                                    <span><b>{{motorista['nome']}}</b></span>
                                                                </div>
                                                            </mat-option>
                                                        </ng-container>
                                                    </mat-autocomplete>
                                                    <mat-error>
                                                        <app-message [control]="formFretamentoEventual.get('custo').get('motorista2')"></app-message>
                                                    </mat-error>
                                                </mat-form-field>

                                                <mat-form-field appearance="outline" fxFlex="15" class="pr-4">
                                                    <mat-label>Total das diária</mat-label>
                                                    <input currencyMask matInput formControlName="valorMotorista2Diaria" (ngModelChange)="calcularDespesas()">
                                                    <mat-error>
                                                        <app-message [control]="formFretamentoEventual.get('custo').get('valorMotorista2Diaria')"></app-message>
                                                    </mat-error>
                                                </mat-form-field>
                                            </div>


                                            <div fxFlex="1 0 auto" fxLayout="row wrap">
                                                <mat-form-field appearance="outline" fxFlex="35" class="pr-4 wcorrea-input-readyonly">
                                                    <mat-label>Veículo</mat-label>
                                                    <mat-icon matSuffix class="secondary-text">directions_bus</mat-icon>
                                                    <input matInput type="text"
                                                           value="{{formFretamentoEventual.get('itinerario').get('veiculo').value ? (formFretamentoEventual.get('itinerario').get('veiculo').value['frota'] + ' - ' +formFretamentoEventual.get('itinerario').get('veiculo').value['placa']) : undefined}}"
                                                           readonly>
                                                </mat-form-field>

                                                <mat-form-field appearance="outline" fxFlex="18" class="pr-4 wcorrea-input-readyonly" *ngIf="formacaoPreco">
                                                    <mat-label>Km TOTAL percorrido</mat-label>
                                                    <span matSuffix class="secondary-text">Km</span>
                                                    <input matInput type="number" style="text-align: right" value="{{formFretamentoEventual.get('itinerario').get('kmPercorridoQuantidade').value}}" readonly>
                                                </mat-form-field>

                                                <mat-form-field appearance="outline" fxFlex="15" class="pr-4 wcorrea-input-readyonly" *ngIf="formacaoPreco">
                                                    <mat-label>Velocidade Média</mat-label>
                                                    <span matSuffix class="secondary-text">Km/h</span>
                                                    <input matInput type="number" style="text-align: right"
                                                           value="{{formFretamentoEventual.get('itinerario').get('veiculo').value ? formFretamentoEventual.get('itinerario').get('veiculo').value['velocidadeMedia'] : undefined}}"
                                                           readonly>
                                                </mat-form-field>

                                                <mat-form-field appearance="outline" fxFlex="15" class="pr-4 wcorrea-input-readyonly" *ngIf="formacaoPreco">
                                                    <mat-label>Consumo</mat-label>
                                                    <span matSuffix class="secondary-text">Km/Lts</span>
                                                    <input matInput type="number" style="text-align: right"
                                                           value="{{formFretamentoEventual.get('itinerario').get('veiculo').value ? formFretamentoEventual.get('itinerario').get('veiculo').value['consumoReal'] : undefined}}"
                                                           readonly>
                                                </mat-form-field>

                                                <mat-form-field appearance="outline" fxFlex="17" class="pr-4">
                                                    <mat-label>Pedágio</mat-label>
                                                    <input currencyMask matInput formControlName="valorPedagio" (ngModelChange)="calcularDespesas()">
                                                    <mat-error>
                                                        <app-message [control]="formFretamentoEventual.get('custo').get('valorPedagio')"></app-message>
                                                    </mat-error>
                                                </mat-form-field>

                                                <mat-form-field id="txtCobrancaAutomatica" appearance="outline" fxFlex="28" class="pr-4">
                                                    <input matInput style="display: none">
                                                    <mat-slide-toggle formControlName="cobrancaAutomatica">Tem sem parar</mat-slide-toggle>
                                                </mat-form-field>

                                            </div>

                                            <div fxFlex="1 0 auto" fxLayoutAlign="start center">
                                                <mat-form-field appearance="outline" fxFlex="20" class="pr-4">
                                                    <mat-label>Estacionamento</mat-label>
                                                    <input currencyMask matInput formControlName="valorEstacionamento" (ngModelChange)="calcularDespesas()">
                                                    <mat-error>
                                                        <app-message [control]="formFretamentoEventual.get('custo').get('valorEstacionamento')"></app-message>
                                                    </mat-error>
                                                </mat-form-field>

                                                <mat-form-field appearance="outline" fxFlex="20" class="pr-4">
                                                    <mat-label>Agua</mat-label>
                                                    <input currencyMask matInput formControlName="valorAgua" (ngModelChange)="calcularDespesas()">
                                                    <mat-error>
                                                        <app-message [control]="formFretamentoEventual.get('custo').get('valorAgua')"></app-message>
                                                    </mat-error>
                                                </mat-form-field>

                                                <mat-form-field appearance="outline" fxFlex="20" class="pr-4">
                                                    <mat-label>Gelo</mat-label>
                                                    <input currencyMask matInput formControlName="valorGelo" (ngModelChange)="calcularDespesas()">
                                                    <mat-error>
                                                        <app-message [control]="formFretamentoEventual.get('custo').get('valorGelo')"></app-message>
                                                    </mat-error>
                                                </mat-form-field>

                                                <mat-form-field appearance="outline" fxFlex="20" class="pr-4">
                                                    <mat-label>Hospedagem</mat-label>
                                                    <input currencyMask matInput formControlName="valorHospedagem" (ngModelChange)="calcularDespesas()">
                                                    <mat-error>
                                                        <app-message [control]="formFretamentoEventual.get('custo').get('valorHospedagem')"></app-message>
                                                    </mat-error>
                                                </mat-form-field>

                                                <mat-form-field appearance="outline" fxFlex="20" class="pr-4">
                                                    <mat-label>Despesas Adicionais</mat-label>
                                                    <input currencyMask matInput formControlName="valorDespesasAdicionais" (ngModelChange)="calcularDespesas()">
                                                    <mat-error>
                                                        <app-message [control]="formFretamentoEventual.get('custo').get('valorDespesasAdicionais')"></app-message>
                                                    </mat-error>
                                                </mat-form-field>
                                            </div>

                                            <div fxFlex="1 0 auto" fxLayoutAlign="start center">
                                                <mat-form-field appearance="outline" fxFlex="20" class="pr-4">
                                                    <mat-label>Valor Combustível</mat-label>
                                                    <input currencyMask matInput formControlName="combustivelValor" (keyup)="calcularDespesas()">
                                                    <mat-error>
                                                        <app-message [control]="formFretamentoEventual.get('custo').get('combustivelValor')"></app-message>
                                                    </mat-error>
                                                </mat-form-field>

                                                <mat-form-field appearance="outline" fxFlex="20" class="pr-4 wcorrea-input-readyonly" *ngIf="formacaoPreco">
                                                    <mat-label>Combustível Lts</mat-label>
                                                    <span matSuffix class="secondary-text">Lts</span>
                                                    <input matInput currencyMask
                                                           [options]="{ prefix: '', thousands: '', decimal: ',', precision: 1, allowNegative: true}"
                                                           formControlName="combustivelLts" readonly>
                                                </mat-form-field>

                                                <mat-form-field appearance="outline" fxFlex="20" class="pr-4 wcorrea-input-readyonly" *ngIf="formacaoPreco">
                                                    <mat-label>Combustível Total</mat-label>
                                                    <input currencyMask matInput formControlName="combustivelTotal" readonly>
                                                </mat-form-field>


                                                <mat-form-field appearance="outline" fxFlex="20" class="pr-4">
                                                    <mat-label>Dinheiro Reserva</mat-label>
                                                    <input currencyMask matInput formControlName="valorDinheiroReserva" style="color: blue;">
                                                    <mat-error>
                                                        <app-message [control]="formFretamentoEventual.get('custo').get('valorDinheiroReserva')"></app-message>
                                                    </mat-error>
                                                </mat-form-field>

                                                <mat-form-field appearance="outline" fxFlex="20" class="pr-4 wcorrea-input-readyonly">
                                                    <mat-label>Imposto da NF</mat-label>
                                                    <input currencyMask matInput formControlName="notaFiscalImposto" readonly style="color: red;">
                                                </mat-form-field>
                                            </div>

                                            <div fxFlex="1 0 auto" fxLayoutAlign="start center">


                                                <div fxFlex="60" fxLayoutAlign="start center" class="pr-4"
                                                     style="background-color: rgba(129, 204, 137,0.33); padding-top: 30px; border-radius: 10px; padding-left: 10px; margin-right: 5px; padding-right: 5px !important; margin-bottom: 10px;">
                                                    <mat-form-field appearance="outline" fxFlex="33" class="pr-4 pl-4" style="font-weight: bold;">
                                                        <mat-label>Preço Viagem %</mat-label>
                                                        <input currencyMask matInput [(ngModel)]="viagemPrecoFinalPorcentagem" [ngModelOptions]="{standalone: true}"
                                                               (keyup)="calcularViagemPrecoFinalPorcentagem()"
                                                               [options]="{ prefix: '', suffix: '%', thousands: '', decimal: ',', precision: 1, allowNegative: true}"
                                                               [disabled]="this.formFretamentoEventual.get('situacao').value == 'CONTRATADO' || this.formFretamentoEventual.get('situacao').value == 'NAO_CONTRATADO'">
                                                    </mat-form-field>

                                                    <mat-form-field appearance="outline" fxFlex="33" class="pr-4">
                                                        <mat-label>Valor Km</mat-label>
                                                        <input currencyMask matInput formControlName="valorKm" (keyup)="calcularViagemKmRodado()">
                                                        <mat-error>
                                                            <app-message [control]="formFretamentoEventual.get('custo').get('valorKm')"></app-message>
                                                        </mat-error>
                                                    </mat-form-field>

                                                    <mat-form-field appearance="outline" fxFlex="33" class="pr-4">
                                                        <mat-label>Viagem Preço Final</mat-label>
                                                        <input currencyMask matInput formControlName="viagemPrecoFinal" (keyup)="calcularDespesas()" style="font-weight: bold;">
                                                        <mat-error>
                                                            <app-message [control]="formFretamentoEventual.get('custo').get('viagemPrecoFinal')"></app-message>
                                                        </mat-error>
                                                    </mat-form-field>
                                                </div>
                                                <div fxFlex="40" fxLayoutAlign="start center"
                                                     style="background-color: rgba(204, 204, 204, 0.33);; padding-top: 30px; border-radius: 10px; padding-left: 10px; padding-right: 10px !important; margin-bottom: 10px;">
                                                    <mat-form-field appearance="outline" fxFlex="50" class="pr-4">
                                                        <mat-label>Ganho Real</mat-label>
                                                        <input currencyMask matInput [ngModel]="ganhoReal" [ngModelOptions]="{standalone: true}" [options]="{allowNegative: true }" readonly style="font-weight: bold;">
                                                    </mat-form-field>

                                                    <mat-form-field appearance="outline" fxFlex="50" class="pr-4">
                                                        <mat-label>Total despesas</mat-label>
                                                        <input currencyMask matInput formControlName="valorTotalDespesas" readonly style="font-weight: bold;">
                                                    </mat-form-field>
                                                </div>
                                            </div>

                                            <div fxFlex="1 0 auto" fxLayoutAlign="start center">
                                                <mat-form-field appearance="outline" fxFlex="100">
                                                    <mat-label>Observações do custo</mat-label>
                                                    <textarea #custoObs matInput rows="3" maxlength="500" formControlName="obsCusto"></textarea>
                                                    <mat-hint align="end">{{custoObs.value.length}} / 500</mat-hint>
                                                    <mat-error>
                                                        <app-message [control]="formFretamentoEventual.get('custo').get('obsCusto')"></app-message>
                                                    </mat-error>
                                                </mat-form-field>
                                            </div>

                                            <div fxLayout="row" fxLayoutAlign="center center">
                                                <button class="mr-8" mat-raised-button matStepperPrevious type="button" color="accent">
                                                    Voltar
                                                </button>
                                                <button mat-raised-button matStepperNext type="button" color="accent">
                                                    Próximo
                                                </button>
                                            </div>
                                        </form>
                                    </mat-step>

                                    <!--   ##############################  -->
                                    <!--   #    CONCLUSAO DO FRETAMENTO    -->
                                    <!--   ##############################  -->
                                    <mat-step [stepControl]="formFretamentoEventual">
                                        <form fxLayout="column" [formGroup]="formFretamentoEventual">
                                            <ng-template matStepLabel>Concluir</ng-template>

                                            <div fxFlex="1 0 auto" fxLayoutAlign="row">
                                                <mat-form-field appearance="outline" fxFlex="33" class="pr-4">
                                                    <mat-label>Representante Comercial</mat-label>
                                                    <mat-select formControlName="representanteComercial" [compareWith]="compararObjetosMatSelect">
                                                        <mat-option *ngFor="let representante of cmbRepresentanteComercial" [value]="representante">
                                                            <div style="display: block;">
                                                                <img *ngIf="(representante['imagem'] != null && representante['imagem'].length > 0)" [src]="representante['imagem']" style="width: 40px; vertical-align: middle; margin-right: 5px; border-radius: 5px;"/>
                                                                <img *ngIf="(representante['imagem'] == null || representante['imagem'].length == 0)" src="assets/wcorrea/img/usuario01.png" style="width: 40px; vertical-align: middle; opacity: 0.4; margin-right: 5px; border-radius: 5px;"/>
                                                                <span><b>{{representante['nome']}}</b></span>
                                                            </div>
                                                        </mat-option>
                                                    </mat-select>
                                                    <mat-error>
                                                        <app-message [control]="formFretamentoEventual.get('representanteComercial')"></app-message>
                                                    </mat-error>
                                                </mat-form-field>

                                                <mat-form-field appearance="outline" fxFlex="34" class="pr-4">
                                                    <mat-label>Empresa prestadora do serviço</mat-label>
                                                    <mat-select formControlName="empresa" [compareWith]="compararObjetosMatSelect">
                                                        <mat-option *ngFor="let empresa of cmbEmpresa" [value]="empresa">
                                                            <div style="display: block;">
                                                                <img *ngIf="(empresa['imagem'] != null && empresa['imagem'].length > 0)" [src]="empresa['imagem']" style="width: 40px; vertical-align: middle; margin-right: 5px; border-radius: 5px;"/>
                                                                <img *ngIf="(empresa['imagem'] == null || empresa['imagem'].length == 0)" src="assets/wcorrea/img/usuario01.png" style="width: 40px; vertical-align: middle; opacity: 0.4; margin-right: 5px; border-radius: 5px;"/>
                                                                <span><b>{{empresa['nome']}}</b></span>
                                                            </div>
                                                        </mat-option>
                                                    </mat-select>
                                                    <mat-error>
                                                        <app-message [control]="formFretamentoEventual.get('empresa')"></app-message>
                                                    </mat-error>
                                                </mat-form-field>

                                                <mat-form-field appearance="outline" fxFlex="33" class="pr-4">
                                                    <mat-label>Data do contrato</mat-label>
                                                    <input matInput formControlName="dataImpressaoContrato" [matDatepicker]="dpDataContratacao">
                                                    <mat-datepicker-toggle matSuffix [for]="dpDataContratacao"></mat-datepicker-toggle>
                                                    <mat-datepicker #dpDataContratacao></mat-datepicker>
                                                    <mat-error>
                                                        <app-message [control]="formFretamentoEventual.get('dataImpressaoContrato')"></app-message>
                                                    </mat-error>
                                                </mat-form-field>

                                            </div>


                                            <div class="h2 m-16" fxLayout="row" fxLayoutAlign="center center">
                                                Concluir cadastro do fretamento?
                                            </div>

                                            <div fxLayout="row" fxLayoutAlign="center center">
                                                <button class="mr-8" mat-raised-button matStepperPrevious type="button" color="accent">
                                                    voltar
                                                </button>
                                                <button mat-raised-button type="button" color="accent" (click)="gravarFretamento()"
                                                        [disabled]="(this.formFretamentoEventual.get('representanteComercial').invalid
                                                            || this.formFretamentoEventual.get('empresa').invalid
                                                            ||  this.formFretamentoEventual.get('dataImpressaoContrato').invalid)
                                                            || (this.formFretamentoEventual.get('situacao').value == 'CONTRATADO'
                                                            || this.formFretamentoEventual.get('situacao').value == 'NAO_CONTRATADO_CONTATO'
                                                            || this.formFretamentoEventual.get('situacao').value == 'NAO_CONTRATADO_CLIENTE')">
                                                    <span>{{tipoPagina === 'NOVO' ? 'Salvar Fretamento' : 'Atualizar Fretamento'}}</span>
                                                </button>
                                            </div>
                                        </form>
                                    </mat-step>


                                </mat-horizontal-stepper>
                                <!-- / HORIZONTAL STEPPER -->
                            </div>
                        </div>

                    </mat-tab> <!-- FINAL DA ABA DE CADASTRO -->

                </mat-tab-group>

            </div>
            <!-- / CONTENT -->

        </div>
        <!-- / CONTENT CARD -->

    </div>
    <!-- / CENTER -->

</div>
